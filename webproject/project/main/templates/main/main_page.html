{% extends "main/layout.html" %} {% block title %} Главная страница {% endblock %} {% block content %}
<div class="container">
    <aside class="sidebar">
        <h2 class="filters">Фильтры:</h2>
        <div class="filter-group">
            <div class="filter-block">
                <div class="filter-title">Назначение:</div>
                <label><input type="radio" name="purpose"> редактор текста</label>
                <label><input type="radio" name="purpose"> бухгалтерия</label>
                <label><input type="radio" name="purpose"> общение</label>
                <label><input type="radio" name="purpose"> работа</label>
                <label><input type="radio" name="purpose"> развлечения</label>
            </div>
            <div class="filter-block">
                <div class="filter-title">Цена:</div>
                <label><input type="radio" name="price"> бесплатно</label>
                <label><input type="radio" name="price"> дорого</label>
            </div>
            <div class="filter-block">
                <div class="filter-title">Устройство:</div>
                <label><input type="radio" name="device"> телефон</label>
                <label><input type="radio" name="device"> пк</label>
            </div>
            <div class="filter-block">
                <div class="filter-title">Доступность:</div>
                <label><input type="radio" name="access"> скачал и запустил</label>
                <label><input type="radio" name="access"> надо разобраться</label>
                <label><input type="radio" name="access"> 3 высших</label>
            </div>
        </div>
    </aside>
    <main class="main">
        <form method="post">
            {% csrf_token %} {{ form.as_p }}
            <input class="search" name='name' type="text" placeholder="Найти программу...">
            <!--  !!!   -->
        </form>
        <h1>Результаты поиска:</h1>
        {% for i in result %}
        <div class="alert alert-warning">

            <h2 class="output"><button class="favorite-btn" aria-pressed="false" data-item-name = {{i}} aria-label="Добавить в избранное"></button>{{i}}</h2>
        </div>
        {% endfor%}
    </main>
    <aside class="recommendations">
        <h2>Рекомендации:</h2>
        <div class="rec-item">
            <img src="https://upload.wikimedia.org/wikipedia/commons/7/75/Max_logo_2025.png" alt="Поиск" class="rec-icon">
            <span>- лучший отечественный месенджер</span>
        </div>
    </aside>
    <script>
        (function() {
        // Список для хранения избранных объектов
        const favoritesDictionary = {};
        
        function toggleFavorite(btn) {
            const pressed = btn.getAttribute('aria-pressed') === 'true';
            const newState = !pressed;
            const itemname = btn.getAttribute('data-item-name') || 'default';
            
            btn.setAttribute('aria-pressed', String(newState));
            btn.classList.toggle('active', newState);
            
            if (newState) {
                favoritesDictionary[itemname] = 1
            } else {
                if (favoritesDictionary[itemname]) {
                    delete favoritesDictionary[itemname];
                }
            }
            
            console.log('Текущие избранные:', favoritesDictionary);
        }
        document.addEventListener('click', function(e) {
            const btn = e.target.closest && e.target.closest('.favorite-btn');
            if (!btn) return;
            toggleFavorite(btn);
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === ' ' || e.key === 'Enter') {
                const active = document.activeElement;
                if (active && active.classList && active.classList.contains('favorite-btn')) {
                    e.preventDefault();
                    toggleFavorite(active);
                }
            }
        });
        
        // Функция для получения всех избранных элементов
        window.getFavorites = function() {
            return [...favoritesDictionary]; // возвращаем копию массива
        };
        
        // Функция для проверки, есть ли элемент в избранном
        window.isFavorite = function(itemId) {
            return favoritesDictionary.some(item => item.id === itemId);
        };
    })();
    </script>
</div>


{% endblock %}