{% extends "main/layout.html" %} {% block title %} –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ {% endblock %} {% block content %}
<div class="container">
    <aside class="sidebar">
        <h2 class="filters">–§–∏–ª—å—Ç—Ä—ã:</h2>

        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
        <div class="theme-toggle-block">
            <span>–¢–µ–º–∞:</span>
            <button id="themeToggle" class="theme-toggle-btn" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
        </div>

        <!-- –ß–∏–ø—ã-—Ñ–∏–ª—å—Ç—Ä—ã -->
        <div class="filter-group">

            <div class="filter-block">
                <div class="filter-title">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:</div>
                <div class="chip-group">
                    <label><input type="radio" name="purpose" value="editor"><span>—Ä–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞</span></label>
                    <label><input type="radio" name="purpose" value="accounting"><span>–±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è</span></label>
                    <label><input type="radio" name="purpose" value="chat"><span>–æ–±—â–µ–Ω–∏–µ</span></label>
                    <label><input type="radio" name="purpose" value="work"><span>—Ä–∞–±–æ—Ç–∞</span></label>
                    <label><input type="radio" name="purpose" value="fun"><span>—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</span></label>
                </div>
            </div>

            <div class="filter-block">
                <div class="filter-title">–¶–µ–Ω–∞:</div>
                <div class="chip-group">
                    <label><input type="radio" name="price" value="free"><span>–±–µ—Å–ø–ª–∞—Ç–Ω–æ</span></label>
                    <label><input type="radio" name="price" value="expensive"><span>–¥–æ—Ä–æ–≥–æ</span></label>
                </div>
            </div>

            <div class="filter-block">
                <div class="filter-title">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</div>
                <div class="chip-group">
                    <label><input type="radio" name="device" value="phone"><span>—Ç–µ–ª–µ—Ñ–æ–Ω</span></label>
                    <label><input type="radio" name="device" value="pc"><span>–ø–∫</span></label>
                </div>
            </div>

            <div class="filter-block">
                <div class="filter-title">–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:</div>
                <div class="chip-group">
                    <label><input type="radio" name="access" value="easy"><span>—Å–∫–∞—á–∞–ª –∏ –∑–∞–ø—É—Å—Ç–∏–ª</span></label>
                    <label><input type="radio" name="access" value="medium"><span>–Ω–∞–¥–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è</span></label>
                    <label><input type="radio" name="access" value="hard"><span>3 –≤—ã—Å—à–∏—Ö</span></label>
                </div>
            </div>
        </div>

        <a href="{% url 'favourites' %}" class="abort">
            <p class="star">‚òÖ</p> –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
    </aside>

    <main class="main">
        <form method="post">
            {% csrf_token %} {{ form.as_p }}
            <input class="search" name='name' type="text" placeholder="–ù–∞–π—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É...">
        </form>

        <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h1>

        {% for name, desc in items %}
        <div class="alert alert-warning">
            {% if name != '–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –º—ã –Ω–µ –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è' %}
            <h2 class="output">
                <button class="favorite-btn" aria-pressed="false" data-item-name={{ name }} aria-label="–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"></button> {{ name }} {% for i in desc %} {% if 'http' not in i and i != '-' %}
                <br>{{ i }} {% endif %} {% if 'http' in i %}
                <br>–°—Å—ã–ª–∫–∞ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ: <a href={{ i }} target="_blank">{{ i }}</a> {% endif %} {% if i == '-' %}
                <br>–°—Å—ã–ª–∫–∞ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ: {{ i }} {% endif %} {% endfor %}
            </h2>
            {% else %}
            <h2 class="output">–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –º—ã –Ω–µ –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>
            {% endif %}
        </div>
        {% endfor %}
    </main>

    <aside class="recommendations">
        <h2>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h2>
        <div class="rec-item">
            <a class="rec-text" href="https://max.ru/" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/7/75/Max_logo_2025.png" class="rec-icon"> - –º–µ—Å–µ–Ω–¥–∂–µ—Ä</a>
            <a class="rec-text" href="https://dzen.ru" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/5/58/Yandex_icon.svg" class="rec-icon"> - –ø–æ–∏—Å–∫–æ–≤–∏–∫</a>
            <a class="rec-text" href="https://elma365.com/ru/" target="_blank"><img src="https://softline.ru/upload/iblock/276/qldcbie6vmyo7mtnsqr74j95rpxl97nn/elma_color_1024.png" class="rec-icon"> - –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç</a>
            <a class="rec-text" href="https://1c.ru/" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/9/93/1C_Company_logo.svg" class="rec-icon"> - –≤—Å–µ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π</a>
            <a class="rec-text" href="https://www.kaspersky.ru/" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/2/25/Kaspersky_logo.svg" class="rec-icon"> - –∞–Ω—Ç–∏–≤–∏—Ä—É—Å</a>
            <a class="rec-text" href="https://rosa.ru/r7-office/" target="_blank"><img src="https://www.irisoft.ru/wp-content/uploads/2022/09/r7o.png" class="rec-icon"> - —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä</a>
        </div>
    </aside>

    <script>
        (function() {
            /* –¢–µ–º–∞ */
            const root = document.documentElement;
            const btn = document.getElementById("themeToggle");
            const saved = localStorage.getItem("theme") || "dark";
            root.setAttribute("data-theme", saved);
            btn.textContent = saved === "light" ? "‚òÄÔ∏è" : "üåô";

            btn.addEventListener("click", () => {
                const current = root.getAttribute("data-theme");
                const next = current === "light" ? "dark" : "light";
                root.setAttribute("data-theme", next);
                localStorage.setItem("theme", next);
                btn.textContent = next === "light" ? "‚òÄÔ∏è" : "üåô";
            });

            /* –ò–∑–±—Ä–∞–Ω–Ω–æ–µ */
            const storageKey = 'favoritesDictionary';

            function loadFavorites() {
                try {
                    const saved = localStorage.getItem(storageKey);
                    if (saved) return JSON.parse(saved) || {};
                } catch {}
                return {};
            }

            function saveFavorites(dict) {
                localStorage.setItem(storageKey, JSON.stringify(dict));
            }

            let favoritesDictionary = loadFavorites();
            if (!favoritesDictionary || Array.isArray(favoritesDictionary)) favoritesDictionary = {};

            document.addEventListener('DOMContentLoaded', function() {
                Object.keys(favoritesDictionary).forEach(item => {
                    const btn = document.querySelector(`[data-item-name="${item}"]`);
                    if (btn) {
                        btn.setAttribute('aria-pressed', 'true');
                        btn.classList.add('active');
                    }
                });
            });

            function toggleFavorite(btn) {
                const itemname = btn.getAttribute('data-item-name');
                const isPressed = btn.getAttribute('aria-pressed') === 'true';

                if (isPressed) {
                    delete favoritesDictionary[itemname];
                    btn.setAttribute('aria-pressed', 'false');
                    btn.classList.remove('active');
                } else {
                    favoritesDictionary[itemname] = 1;
                    btn.setAttribute('aria-pressed', 'true');
                    btn.classList.add('active');
                }
                saveFavorites(favoritesDictionary);
            }

            document.addEventListener('click', function(e) {
                if (e.target.closest('.favorite-btn')) {
                    toggleFavorite(e.target.closest('.favorite-btn'));
                }
            });
        })();
    </script>
</div>
{% endblock %}